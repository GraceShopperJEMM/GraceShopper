'use strict'

const db = require('../server/db')
const {User, Product} = require('../server/db/models')

async function seed() {
  await db.sync({force: true})
  console.log('db synced!')

  const users = await Promise.all([
    User.create({name: 'Cody', email: 'cody@email.com', password: '123'}),
    User.create({name: 'Murphy', email: 'murphy@email.com', password: '123'})
  ])

  const products = await Promise.all([
    Product.create({
      name: 'Regular Duck',
      price: 19.99,
      color: 'Yellow',
      stock: 8,
      size: 'Medium',
      imageUrl:
        'https://images-na.ssl-images-amazon.com/images/I/8166xCVDGnL._SY355_.jpg'
    }),
    Product.create({
      name: 'Punk Rock Duck',
      price: 29.99,
      color: 'Blue',
      stock: 3,
      size: 'Small',
      imageUrl:
        'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxISEhUQEBIPFRUQFQ8VEBUVFQ8WEhUQFRUWFhUVFRUYHSggGBolHRUVITIhJSkrLi4uFx8zODMtOCgtLisBCgoKDg0OGhAQGi0lHx0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLf/AABEIAOEA4QMBEQACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAAAgMBBAcGBQj/xABBEAACAgACBwQFCgUCBwAAAAAAAQIDBBEFBhIhMUFRBxNhcSIygZGhFEJSYnKCsbLB0SMzQ5LC0uEVJCVzg6Kz/8QAGwEBAAMBAQEBAAAAAAAAAAAAAAECAwUEBgf/xAAyEQEAAgIBAwIDBgYCAwAAAAAAAQIDEQQSITEFURNBYRQiMnGBoQYzQlKR0SOxFsHh/9oADAMBAAIRAxEAPwDuIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARnNJZtpJcW9yXtA+Fjtc8BVulia21yr2rPyJo1rgyW8QytmpHmXybe03ArgsRLyhFfmkjWOHklnPLxwqn2pYTlVin92pf5mkcDLPsztz8Ue7YwPaVgZvKffVZ85wzj74N5e0rfg5a/VanNxW+j1mFxULYqyqcJxl6sotOL8mjyTExOpeqJiY3C4hIAAAAAAAAAAAAAAAAAAAAAAAAeP1v17qwjdNKVt64rP8Ah1v67XF/VXtyPTh41snefDz5uRWnb5uT6Z09iMVLPEWykuUeFa8oLd7eJ1MeCtPEOZk5FreZfN2j0RjeacojWtIY2yS2asM2X1EMdzKFtTQmu01tMS+xqnrRZgLdqOcqpv8AjVZ7mvpRz4TXx4Pw53K40Xj6ulxOTNJ+juOitJVYmqN9ElKE1ufNPmmuTXQ4tqzWdS7dbRaNw2yqwAAAAAAAAAAAAAAAAAAAAAB4TtE1yeHTwuGl/Gkv4k1/Si1uS+u17lv6Hr43H656p8PLyM/RGo8uQSlzfF8euZ2KUca+Rg2irC1kowNYhlMtiuksr3luU3OC4JkTG07mGviL8+Q0je2haszK8NqTp6TUPWl4G/KbfcXNK5covgrV4rn1Xkjl8rB1RuPMOtxc/T58O7xkmk0008mmuDT5o5LqsgAAAAAAAAAAAAAAAAAAAA+RrXppYPDTveTl6tSfzrZeqvLi34JmmLH12irPLforNnAMViZTlKc5OUptylJ8XJvNtnex0iI1DhZckzO5UHpiHkmVsIl4hnMtyijMsiI23oVZEbaaV2xJUmGlbEKNaaM5aVUWI82SHsxWd17O9NLEYWEXJbdcUmt2eyt2eXRNNe44OanTeYd7Dfqq9UZNQAAAAAAAAAAAAAAAAAAAOR9sGldq+vDJ+jTHbn/3J8M/KKX9x0uDTtNnO5t+8Vc8zOrWHHvO5TibQzlsU8SzOX08MhK8NtpZcSFmpdIbVlp2PPpzG1dNaZEkKJo893pxy+xqnpuWFuhav6cvSzzydFmzG5ezKEvutnK5mP8Aqh1+Jfvp+hIvPeufA57oMgAAAAAAAAAAAAAAANTFaUorezbfRB9J2VxfubLRS0+IVm1Y8y2KrIySlFqSfBppp+TRVZMD8664YzvcbibOt1kV9mD2I/CKO5xq6pEOJyrbvMvjxZ7YeCV0GaQpLYqZeGUt6mYTEr3Mqvt0zUzQ9dVELnGLtuipuTSbjCW+MY9N2Wfj7DicvNa+Sa/KHU4+OK0ifnL5Ol8XozSFksJC+n5THaUJRTUtqOeaU8lG1LJ5xTeSTe7iUw5rY57T+jTLx+uveP1c2xNMoSlCaylCUoyXSUXk/wADs1tFo3Dk2pNZ1LWmilpaUU7TTzXFe7yfVeB5MkRMae7FOneezfTHyrAwlLLbpcqpr7Hq/wDo4nIy06badbFbqrt6gzaAAAAAAAAAAAAAAOcdo+u0qpPB4SWU8v49i4wz+ZB8pdXy8+HQ4nF6/v28OdzOVNPuU8/NyS+Tbbbbbzbb3tvq3zOt0xEOT1TMr9FaaxGFlt4e6yt81F+i/tRe6XtRhkw1v+KHoxZbU8S6nql2o125VY5Rqm9ytX8mT+tn6j8d68jmZuJNe9e7p4eXFu1uzlulJZ22PrZa8+Tzm950sHasOdyPMtZM9cPHK2BeFJbFbLwylsQkWZrlMrMLxLqmgcU79HKNTynGmdK6xthBwj5fNftOBycc1y2+vf8Ay7PGvE0r9H57li5wjTCqmFd2Gsm4zjGSvndtpwhPrsSjspZdfE823T1vy9/rxBLG25Zb+6ckuUnXHP8Af2nZ48/8cOFyI+++FCpyajFNt7klxbKZ89MVZvedRC2HFa86iH14amYhxUpuEM/mvOU15pbvifLZf4p4s36McTb6+Id3F6Tl6d2nT1vZtngbLa77F3dyg08pbrY5rhv3NPj9VGkepYs/fw1rxbY/q6TVpCmW+NtT8pRNovWfEnTKTxlXDvK/7o/uROSsfODpn2XRknvWTRdDIAAAAAAAAAB8PXLTqwWFndu236FKfO2XDdzS3yfhFmuDF8S8VY58vw6TZwNtvOcm3KbcpN72297bfVs+ipWIjUPnLTNp3LUsLSVa8ikw1hHMzmF4bEZZorXytfwyj0Q80rIsupLYrLwysuiy8M5WKQRD6+rmsNmEm2ltQnl3kM8s8uEovlJfH3ZeXkYIyR9XqwZpo+3itO6L7z5YsI5YjPaTdcIy21wlKWezmt3pZNnO+x23306H2yNah47G4md9srJb52yzyS5vcope5LyPTe1cVNzOohjWJyW/N0DVrVyOHirJpSta4/RT5Lx8T8l9c9dyc7JNKTrHH7/WX13B4VcFdz5fYtjmcKs6dSGvOpdD0U5F48SiawlTgk/motbm5I+asxWFGk8bXStiKUp9Fy8zXicTNy7dUz933/0rOSK95fX1Fru2bLLM1Cez3cerWeckunDzPufTuPOHH0/JzOTki9nqzoPMAAAAAAAAAOM9rWl++xccNF+hhl6XR2zScvdHZXvOvwMeq9Xu5HqGTdop7PH3PdkdOIcyWlMSmFMkUlpEq2ikrxKdUuRT5r/JajasvPMLImkKSugyzOYXRZaGcppkqmZEphhmF7aejHWZe41L1fUUsVavSaTpi0/RX02ur5dPafmP8UeuzkvPEwz2j8U+/wBPy931vpnBikRlv5nw9dI+Jh24VMsulThnJ+HwLV3M6hW+SKw+NrNrHCjOqlqU+b5I9/D9P+Lbrv8Ah/7/APjLcx3t5a3Z7ZViL5QvjtS2dutv1W0/STXznvT39GfacGKfg148PFyOry6illuR1XjZAAAAAAAAAV4m5QhKyXCEZSl5RWb/AAJiN9iez82XYqV107p+tbOc5ecm2/xPo8NemsR7Pmc1+q8z7sXs3hk1JEStCuTKrwqkzOV4hBmctYW12ZmlZZXqvizWJYyugy8M5hbGRO1JhNSJ2rplMradQtWNy9NqloHv597Yl3Vb3r6dm5qPlvzfs6nxH8S+ufZcM4sc/ft+0fOf9Po/TODF7ddvEOiZH5bvb6hhoJYaS3vJJDvPg3vw8frHra23h8Jm290pr/E7XD9OiI+Jm/x/tnNtT28vj6N1Ztse1bms9+/i/M9ebn0p2ovXFM95ew0Ho6NFtUocVOK9kvRfwbKem829uXT6z/2nPjr8K35OiH3bhgAAAAAAAADznaJi+70diGuM4Ktf+SSg/hJm3HrvJVjyLaxWcEoPoqvm7eU7pFkNabKyvEKJMpLSGFEjSdpbI6SLNafovMp4lrH3oXVXmkWZWo2YWGkSymq1WFtqdLPeDaOlh3FLT2WrXUumamaVp+S1xTims9tZ/Pzeb9vHyaPyD+JOHyPt17WiZifH5PuPTbUtx66/X833/lcvm1t+Uqv9R898KI8zr9J/09/TCDvvfq05fanWl8GyejFHm/7Sj7sNPGaHvv3W2qMOca89/nJm2PlYsPeldz7yibRMaXYDQFNPqQWfV72Uy8zLl/FJWYjw3ZwyXgYxEz3aRO5fQ0Po1uStmslHfBPi3yfkfXehel3rb7RljWvEf+3j5fIjp+HX5+XoD6xzAAAAAAAAAB4ftgtywKj9O6pe6M5f4nq4cf8AK8vM/lS4tBneh8/LE5E7TEKZFZXhhIhO0kidK7ZaJNqrK8ylq7aVtppyraMtTDeLRJG5losTSFixBbrUnGz8oY6z4cIu1lZtKYpCVGInB5wbT5+Pmjz5sFMsavG22PLbHO6zpux05iFwm1/d+54LelcafNXrrz83ushrTi48LZfH9zy39F4dvOOG9fUM/wDc2adfMcuFq9sUzx3/AId4Fv6P3ax6hm+n+G7R2gYzajtzi4prbUYxUpRz3rN55PLnkY/+N8CP6P3lePUMv0/w7TqjpPB4upW4bJtZKyM8nbCXSS/VbmbYvTeNx5+5jiJ9/P7ytPIvkjvL0R62YAAAAAAAAAAeB7ZY/wDJ1vpiIf8AzsPXwv5n6PJzP5bjOZ3IlwtMNhOkQMpAZJQyToYaGjaLgR0rRZB0LoR0LfEkWEQ+GfGlZHAD4avxpXQ0d4E9EI+JK35CkR0nVKm3Dor0LRk007MKZ2xNa5lMsKY2xNq5ke6aMbY29cj6egNMX4O6N9EspR4r5s484yXNMxvj32bVya7v0XqtrBVjsPG+rc+FkOcLFxi/0fNM8VqzWdS9dbRaNw+uVWAAAAAAAAAHju1ija0fOS/p2Uy98tj/ADPRxZ1kh5+VG8cuG5HarO3FtEQrnuNGcGY2aZiyUTCRKAshkkMgbSUQjayKLKSuhInSu16mRpbqJyzI0mZa00ERKmcSswtEqpIzmF4lW4lJq1rZHZMLUeil3ptQNYngcVGTb7q3KF65bLe6fnF7/LM8ebFuHsw5NS/Qaee9c+Bz3vZAAAAAAAAAfL1nwPf4S+lcZ1WKP20s4/FIvjt02iVL16qzD85Hdxy4WWFdiNpYQzskxBM90ZRJIkTBMJItCqSJQkiUJJBEpJFldrYoIWIJCBCaISpkiJSqkisrQraKSvEoMpaGlZEee8PVSXeOy7TLxGCjGTznhn3UuriknB/27vus5WanTZ1MNuqr2Bi1AAAAAAAAAH5y1owapxeIqSyULbNldIt5x+DR2+PbdIlxeRXV5h8lnqh4p7Syi8KsuJbSNoSiNLRIhBKaJVlJIlVNIlEpJBVbFEiaIWgYEGQmFUiBVIhKtorK0IMpK8SwjC8PTjl0TsXxjjiraeVtW196uSy+E5HO5Ve0S6PGnvp2M8T2AAAAAAAAADiXaxg+7x7ml/Prqm/tLOt/kR0+HbdNezm8uur793i2jo1lzLwwjSGcrEi8KSlsEo2hKsaTFmUgbZSCEkiULIoIWwQWiFmRCUJICEkEKZIhKuRArZWVoQkVleGDGz043seyZ/8AUa/Gu/8AKc/lfhdDjfid1Oe9wAAAAAAAAA5z2yaL2qqsVFfypOuz7E8tlvyksvvnr4l9WmPd5OVTdYn2cmaOrWXKvVA3iXnmE4svEs5X1sspK7YTJSi6QaUtAZQQtiiEwsiFoSzCUZSCNqpMKq5MCuRWVlcisrQrZWWkMZGFnppD2HZXF/8AEK2uUbM/LI53Kntp0eNHd3Y8L2AAAAAAAAADU0rgIYimyiz1bYuL8M+DXink/YTW01ncItWLRqX530vo2zDXTw9q9Kt5Po1ykvBrJ+07OO8WiJhyMlJrMxLSaPVWXjtURpEsZhOLLxKkw2K7CVVqkFolRbxCEYsIWRkBJSCdjkE7Qcgqg2FtItkJQkQlWysrQjkZ2lrSGDC0vTSHROxvA7WJsufCqGS+1N5fgmcrkW3bTqYK6q7CeduAAAAAAAAAAHju0TVP5ZWraYrv6l6PBd5Di4Px5r29TfBm6J7+GGbF1x9XE7IOLaaaabTT3NNcU0delolyb00gb1l57QymaQxmE4yLRKswntk7RpGUgnQmDTKYRpLaBpjMJ0xmQRDDISwBCRWVoQKzK8QwzG0vRWrCPLlvqHrxU3Ond+zXQbw2EUpevflOS6L5q9xy7TuXTrGoetKpAAAAAAAAAAAB4TX7UdYlPEYdJXLfNcrEl+Y9GHPNO3yYZsMX7/Nx66mUG4yTTXFM6uPLFo7OVkxTXyrN4s880MzSJZTVLaJ2rpjaJ2aZTG0JZk7GcyBjMBmAzIEWyNraQZWZXirBlMtq1RbML3iIenHTfh7zs31MlfZHFXxapg04Jr15Lh7DmZsvVLpYsfTDtCMGwAAAAAAAAAAAAAD4GsuqWHxqzmtma4Tjln7epel5rO4VtSLeXLtO9nmMozlCKugucPWy8Yv9D3Y+Z/c8WTif2vI3VSg8pxlF9JJp+5nspnrPiXjvgtHmEGzWLsZxheLM7UEy3UpNUsydo6WdonaNMZjZ0iZG0xVlsrtfpRzKzZaKotmc2a1oRTb2Yptvgks37jz5M0VenHhmXSdRuzly2cRjllHc66ub6OfTyOdlzTaXQx4orDq9VailGKSS3JLckjBskAAAAAAAAAAAAAAAAAaOkND4e9ZXU1z+1FN+8mJmEaeUxvZdgZ5uvvKm/ovNe5l65bR4UnHWfLzGk+ynERzeHtqsXKMs4Sy896PVTmTHl578SJ8PK6S1XxuH/m4e1LrFbcffHM9NeXSXmtxLQ+RLdue7z3G0Z6z82M4LezG0afEhn8KTMfER8JnMj4i0YmHPxKTliPm0jDM/Ju6O0RiMQ8qKLZ+Ki1H3s89+VWG9OLZ7DQ3ZXibGnibI0x5qPpT9/A8t+TM+Hqpx4jy6Lq9qdhMGk6q1KfOc8pS/2PLNpl6IrEPQEJAAAAAAAAAAAAAAAAAAAAAAMNAaWJ0Ph7N1lFMvOEf2J3KNQ+VfqNo6fHC1L7Oa/Anrt7o6Ya8uzrRr/oZeU7P3J+Jb3R0VK+zvRq3/ACdPzlN/qPiW909EPrYXVzB1/wAvDUR+5H9Su5TqH0664xWUUkuiSS+BCUgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/2Q=='
    })
  ])

  console.log(`seeded ${users.length} users`)
  console.log(`seeded ${products.length} products`)
  console.log(`seeded successfully`)
}

// We've separated the `seed` function from the `runSeed` function.
// This way we can isolate the error handling and exit trapping.
// The `seed` function is concerned only with modifying the database.
async function runSeed() {
  console.log('seeding...')
  try {
    await seed()
  } catch (err) {
    console.error(err)
    process.exitCode = 1
  } finally {
    console.log('closing db connection')
    await db.close()
    console.log('db connection closed')
  }
}

// Execute the `seed` function, IF we ran this module directly (`node seed`).
// `Async` functions always return a promise, so we can use `catch` to handle
// any errors that might occur inside of `seed`.
if (module === require.main) {
  runSeed()
}

// we export the seed function for testing purposes (see `./seed.spec.js`)
module.exports = seed
